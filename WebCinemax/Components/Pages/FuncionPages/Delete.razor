@page "/funcions/delete/{IdFuncion:int}"
@using WebCinemax.Models
@using WebCinemax.Services
@inject FuncionService FuncionService
@inject NavigationManager NavigationManager

<PageTitle>Eliminar Función</PageTitle>

<h1>Eliminar Función</h1>

<p>¿Seguro que deseas eliminar esta función?</p>

@if (funcion is null)
{
    <p><em>Cargando...</em></p>
}
else
{
    <div>
        <dl class="row">
            <dt class="col-sm-2">Película</dt>
            <dd class="col-sm-10">@funcion.IdPeliculaNavigation?.Titulo</dd>

            <dt class="col-sm-2">Sala</dt>
            <dd class="col-sm-10">@funcion.IdSalaNavigation?.Nombre</dd>

            <dt class="col-sm-2">Fecha y Hora</dt>
            <dd class="col-sm-10">@funcion.FechaHora.ToString("g")</dd>

            <dt class="col-sm-2">Precio Entrada</dt>
            <dd class="col-sm-10">@funcion.PrecioEntrada.ToString("C")</dd>
        </dl>

        <EditForm Model="funcion" OnValidSubmit="DeleteFuncion">
            <button type="submit" class="btn btn-danger">Eliminar</button> |
            <a class="btn btn-secondary" href="/funcions">Cancelar</a>
        </EditForm>
    </div>
}

@code {
    [Parameter]
    public int IdFuncion { get; set; }

    private Funcion? funcion;

    protected override async Task OnInitializedAsync()
    {
        funcion = await FuncionService.GetByIdAsync(IdFuncion);

        if (funcion is null)
        {
            NavigationManager.NavigateTo("/notfound");
        }
    }

    private async Task DeleteFuncion()
    {
        await FuncionService.DeleteAsync(IdFuncion);
        NavigationManager.NavigateTo("/funcions");
    }
}
